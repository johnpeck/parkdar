* parkdar progress
* ----------------------- Dated notes ---------------------------
* <2011-12-30 Fri> Created this project.
* <2012-01-01 Sun> Created minicom configuration.
  - As long as the FTDI dongle enumerates as /dev/ttyUSB0, simply starting minicom with "minicom parkdar" will bring up the terminal with all the right settings.  I had to configure minicom as root to set this configuration.
* <2012-01-18 Wed> Created the ranger branch
  - This branch will just exist to demonstrate the rangefinder.

*------------- Tasks ------------------
* <2012-02-18 Sat> Created puTTy configuration

* -------------------- Specifications ---------------------------
* System status and debugging messages must be able to be turned off.
*** TODO All status messages must be printed using the logger module
*** TODO Direct replies from the command module can never be disabled
    - These are things like measurement results and status query replies.  
* There must be a command to set the slope and offset pieces of a calibration structure.
    - This takes care of my desire to have a command that takes a numeric parameter
* ------------------------ TODO list ----------------------------
* DONE Change references to LED in the code
  - The LED is now at PB6. The idea was that I'll never use OC1B.
  - Also update the drawing to point to where LED goes.
* TODO Order cheap license plate frame
* TODO Set up timer0 to operate in CTC mode
  - This is instead of timer2.  I'll use timer0 to generate my square wave for the beep tone.  I'll use timer1 to generate an interrupt on a compare match that will stop timer0 (end the beep).  The beep will start again when timer1 overflows.
  - Timer0 is 8-bit -- with a 1MHz/256 clock, the maximum OC0A toggle frequency is 3.9kHz/2 = 1.85kHz.  The minimum toggle frequency is 3.9kHz/(2 * 255) = 7.6 Hz.  So use a 256 clock divider.
  - There is a compare match and an overflow compare signal generated by timer1.  Timer1 is 16-bits, which makes it more appropriate for the 10-bit ADC.
* TODO Set up timer1 to count and generate interrupts.
  - 1MHz/2**16 ~ 15Hz.  Is this ok for the beep frequency?  I can slow it down by dividing the timer1 clock.
* DONE Create function to read ADC input and average results.
* DONE Create function to apply calibration to averaged ADC data.
* DONE Create wiring harness for ranger module
* DONE Connect mta100 header to J402
  - This is for ADC4 as shown in the [[file:implement/drawings/butterfly_connect.fig][drawing]].
* DONE Modify code to select ADC4 as analog input.
* TODO Add command parser for two commands [8/12]
** range?
*** Returns calibrated range in inches from one of the latest measurements
** uncal?
*** Returns uncalibrated ADC counts from one of the latest measurements
** DONE Work on state diagram for incoming commands
*** State diagram is [[file:implement/howto/figs/parse_cmd_flow.fig][here]].
** DONE Work on state diagram for incoming characters
*** State diagram is [[file:implement/howto/figs/recv_cmd_flow.fig][here]]. 
** TODO Make a function called slope
   - Takes a hex number and writes it to the cal_struct
** DONE Port receive_isr_proto to the butterfly [3/3]
*** DONE Remove existing scanRx from main() and from main.c, main.h
*** DONE Copy over pd_command, add pd_command.h to main.c, and pd_command.c to makefile
*** DONE Make ISR write to the new command status structure
** DONE Make a global structure to keep track of the received character state
   - Character count
** DONE Make a flow diagram for command parsing
** TODO Figure out how to convert hex string to integer
   - This can be rolled up with figuring out if my function pointers can take and return arguments.  I'll make a function that takes in a string of characters, and converts them to a number (if possible).
* TODO Work on logging system [/]
** TODO Add logging remote commands [/]
*** TODO logset -- set or query the enable value of the logging configuration structure
**** Argument: hex value of enable data
**** Return value: hex value of the enable data
*** TODO logsys -- set only command that enables a system for logging.
**** Argument: string name of system
** TODO Add command_exec() function to command.c
   - This function will take a pointer to the member of command_array[] that you want executed along with a pointer to the argument you want passed.  This pointer will of course be NULL for commands that don't take an argument.
* TODO Add section on command parsing to the howto
* TODO Adjust one pencil channel's offset to 3.3V
* TODO Stock pencils power supply rise time is too slow
** The fix is to replace C402 with 3.3nF (11-10).  This speeds up the output rise time to about 1.5V/ms, which is fast enough to activate the atmega169's power-on reset.
** Don't mark this as done until there's another revision of the power supply hardware.
* TODO Order water-clean flux remover pen			   :mcmaster:
